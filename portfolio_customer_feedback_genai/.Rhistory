sentiment_ai(
"Excellent unit.  The versatility of this tablet, besides being competitively priced is a solution to the elderly.  Poor eyesight and physical disabilities associated with age and using the supporting add on features allows the user to stay in touch with our changing world.<br />A realistic add on keyboard that you can see and use.<br />I cannot wait to use my Fire HD7 to show computer created work sheets and class instructions to my students. (HMDI) Good by to copiers and reams of paper, Farwell to those costly printer inks!<br /><br />Oh yes I have much more to gain back.  Just takes a little effort to learn more, open a book and read.<br />Noel"
)
sentiment_ai(
"We have two kindle fires. The 7 and the 6. They will not connect to my WiFi and if I finally get them to connect it only lasts for a few minutes. I have tried everything to fix but nothing works. I will never buy another kindle fire... Amazon doesn't offer any help to fix the problem"
)
sentiment_ai(
"it does the job"
)
#review_ai_sentiment <- review_verified_purch %>%
#  mutate(sentiment_2 = sapply(review_body, sentiment_ai))
#write.csv(review_ai_sentiment, "review_ai_sentiment.csv")
review_ai_sentiment <- read.csv("review_ai_sentiment.csv")
differing_sentiment <- review_ai_sentiment %>%
filter(sentiment == 1 & sentiment_2 == -1) %>%
select(review_body, sentiment, sentiment_2)
datatable(differing_sentiment, options = list(pageLength = 5), escape = FALSE) %>%
formatStyle(columns = names(df), `font-size` = '10px')
pos_reviews <- review_ai_sentiment %>% filter(sentiment_2 == 1)
neu_reviews <- review_ai_sentiment %>% filter(sentiment_2 == 0)
neg_reviews <- review_ai_sentiment %>% filter(sentiment_2 == -1)
pos_comments <- paste(pos_reviews$review_body, collapse = "\n")
neu_comments <- paste(neu_reviews$review_body, collapse = "\n")
neg_comments <- paste(neg_reviews$review_body, collapse = "\n")
# pos_review_summary <- gen_ai_function(
#   sys_content = "you are reading a list of positive comments on a tablet product review. Summarize the the top 5 reasons for positive reviews with a short explanation" ,
#   user_content= pos_comments
#   )
#
# write.csv(pos_review_summary, "pos_review_summary.csv")
pos_review_summary <- read.csv("pos_review_summary.csv")
pos_review_summary$x
# neg_review_summary <- gen_ai_function(
#   sys_content = "you are reading a list of negative comments on a tablet product review. Summarize the the top 5 reasons for negative reviews with a short explanation" ,
#   user_content= neg_comments
#   )
# write.csv(neg_review_summary, "neg_review_summary.csv")
neg_review_summary <- read.csv("neg_review_summary.csv")
neg_review_summary$x
# pos_categories <- gen_ai_function(
#   sys_content =
#       "you are reading a list of positive comments on a tablet product review. Choose 10 categories that describe the things a customer liked about the product. The categories should be only 1 or 2 words. Do not duplicate or choose similar categories. Provide your response as a comma seperated list. Do not use formatting.",
#    user_content = pos_comments
#       )
#
# write.csv(pos_categories, "pos_categories.csv")
pos_categories <- read.csv("pos_categories.csv")
pos_categories <- pos_categories$x
print(pos_categories)
classification_ai <- function(string, categories) {
chat(
sys_content = paste0("You are reading user reviews on a tablet product. classify the review in one of the following categories: ", categories, " or OTHER. ONLY respond with these categories. Do not deviate from these categores. Only choose OTHER when none of the other categories truly do not fit. Do not choose more than one category"),
user_content = string
)
}
# pos_reviews <- pos_reviews %>%
#  mutate(category = map_chr(review_body, ~ classification_ai(categories = pos_categories, .)))
#
# write.csv(pos_reviews, "pos_reviews.csv")
pos_reviews <- read.csv("pos_reviews.csv")
unique(pos_reviews$category)
pos_reviews <- pos_reviews %>%
mutate(category_cleaned = str_to_title(category))
unique(pos_reviews$category_cleaned)
pos_reviews_summary_table <- pos_reviews %>%
group_by(category_cleaned) %>%
summarise(n_records = n()) %>%
arrange(-n_records)
pos_reviews_summary_table
ggplot(pos_reviews_summary_table, aes(x = reorder(category_cleaned, n_records), y = n_records)) +
geom_bar(stat = "identity", fill = "steelblue") +
coord_flip() +
labs(
title = "Reasons for Positive Reviews - By Category",
x = "Category",
y = "Number of Reviews"
) +
theme_minimal()
# neg_categories <- gen_ai_function(
#   sys_content =
#        "you are reading a list of negative comments on a tablet product review. Choose 10 categories that describe the things a customer did not like about the product. The categories should be only 1 or 2 words. Do not duplicate or choose similar categories. Provide your response as a comma seperated list. Do not use formatting.",
#   user_content = neg_comments
#      )
#
# write.csv(neg_categories, "neg_categories.csv")
neg_categories <- read.csv("neg_categories.csv")
neg_categories <- neg_categories$x
# neg_reviews <- neg_reviews %>%
#   mutate(category = map_chr(review_body, ~ classification_ai(categories = neg_categories, .)))
#
# write.csv(neg_reviews, "neg_reviews.csv")
neg_reviews <- read.csv("neg_reviews.csv")
neg_reviews <- neg_reviews %>%
mutate(category_cleaned = str_to_title(category))
unique(neg_reviews$category_cleaned)
neg_reviews_summary_table <- neg_reviews %>%
group_by(category_cleaned) %>%
summarise(n_records = n()) %>%
arrange(-n_records)
ggplot(neg_reviews_summary_table, aes(x = reorder(category_cleaned, n_records), y = n_records)) +
geom_bar(stat = "identity", fill = "steelblue") +
coord_flip() +
labs(
title = "Reasons for Negative Reviews - By Category",
x = "Category",
y = "Number of Reviews"
) +
theme_minimal()
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
View(view_pos_reviews)
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neg_reviews <- neg_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neu_reviews <- neu_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date) %>%
mutate(sentiment_2 = null, category_cleaned = null)
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neg_reviews <- neg_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neu_reviews <- neu_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date) %>%
mutate(sentiment_2 == null, category_cleaned == null)
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neg_reviews <- neg_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neu_reviews <- neu_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date) %>%
mutate(sentiment_2 = NULL, category_cleaned = NULL)
View(view_neu_reviews)
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neg_reviews <- neg_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neu_reviews <- neu_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date) %>%
mutate(sentiment_2 = NULL, category_cleaned = NULL)
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neg_reviews <- neg_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neu_reviews <- neu_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date) %>%
mutate(sentiment_2 = NA, category_cleaned = NA)
View(view_neu_reviews)
View(view_neu_reviews)
View(neu_reviews)
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neg_reviews <- neg_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neu_reviews <- neu_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2) %>%
mutate(category_cleaned = NA)
View(view_neu_reviews)
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neg_reviews <- neg_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neu_reviews <- neu_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2) %>%
mutate(category_cleaned = "Uncatagorized")
View(view_neu_reviews)
#| include: false
RequiredPackages <- c("dplyr", "httr2", "readxl", "purrr", "ggplot2", "DT", "knitr", "stringr")
for (i in RequiredPackages) { #Installs packages if not yet installed
if (!require(i, character.only = TRUE)) install.packages(i)
}
library(dplyr)
library(httr2)
library(readxl)
library(purrr)
library(ggplot2)
library(DT)
library(knitr)
library(stringr)
table_reviews <- union(view_pos_reviews, view_neg_reviews, view_neu_reviews)
?union
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neg_reviews <- neg_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neu_reviews <- neu_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2) %>%
mutate(category_cleaned = "Uncatagorized")
table_reviews <- union(view_pos_reviews, view_neg_reviews, view_neu_reviews)
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neg_reviews <- neg_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned)
view_neu_reviews <- neu_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2) %>%
mutate(category_cleaned = "Uncatagorized")
table_reviews <- bind_rows(view_pos_reviews, view_neg_reviews, view_neu_reviews)
View(table_reviews)
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned) %>%
mutate(sentiment_catagory = "Positive")
view_neg_reviews <- neg_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned) %>%
mutate(sentiment_catagory = "Negative")
view_neu_reviews <- neu_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2) %>%
mutate(category_cleaned = "Uncatagorized", sentiment_catagory = "Neutral")
table_reviews <- bind_rows(view_pos_reviews, view_neg_reviews, view_neu_reviews)
View(table_reviews)
View(table_reviews)
unique(table_reviews$product_parent)
product_parent_n <- unique(table_reviews$product_parent)
View(pos_review_summary)
View(pos_review_summary)
table_review_ai_summary <- tibble(
product_parent = product_parent_n, pos_review_summary = pos_review_summary$x
)
View(table_review_ai_summary)
table_review_ai_summary <- tibble(
product_parent = product_parent_n, pos_review_summary = pos_review_summary$x, neg_review_summary = neg_review_summary$x
)
View(table_review_ai_summary)
#| include: false
RequiredPackages <- c("dplyr", "httr2", "readxl", "writexl", "purrr", "ggplot2", "DT", "knitr", "stringr")
for (i in RequiredPackages) { #Installs packages if not yet installed
if (!require(i, character.only = TRUE)) install.packages(i)
}
library(dplyr)
library(httr2)
library(readxl)
library(writexl)
library(purrr)
library(ggplot2)
library(DT)
library(knitr)
library(stringr)
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned) %>%
mutate(sentiment_catagory = "Positive")
view_neg_reviews <- neg_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned) %>%
mutate(sentiment_catagory = "Negative")
view_neu_reviews <- neu_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2) %>%
mutate(category_cleaned = "Uncatagorized", sentiment_catagory = "Neutral")
table_reviews <- bind_rows(view_pos_reviews, view_neg_reviews, view_neu_reviews)
product_parent_n <- unique(table_reviews$product_parent)
table_review_ai_summary <- tibble(
product_parent = product_parent_n, pos_review_summary = pos_review_summary$x, neg_review_summary = neg_review_summary$x
)
write_xlsx(
list(table_reviews = table_reviews, table_review_ai_summary = table_review_ai_summary),
path = "tableau_data.xlsx"
)
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned) %>%
mutate(sentiment_catagory = "Positive")
view_neg_reviews <- neg_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned) %>%
mutate(sentiment_catagory = "Negative")
view_neu_reviews <- neu_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2) %>%
mutate(category_cleaned = "Uncatagorized", sentiment_catagory = "Neutral")
table_reviews <- bind_rows(view_pos_reviews, view_neg_reviews, view_neu_reviews)
product_parent_n <- unique(table_reviews$product_parent)
table_review_ai_summary <- tibble(
product_parent = product_parent_n, pos_review_summary = pos_review_summary$x, neg_review_summary = neg_review_summary$x
)
write_xlsx(
list(table_reviews = table_reviews, table_review_ai_summary = table_review_ai_summary),
path = paste0(product_parent_n, "_tableau_data.xlsx")
)
#| include: false
RequiredPackages <- c("dplyr", "httr2", "readxl", "writexl", "purrr", "ggplot2", "DT", "knitr", "stringr")
for (i in RequiredPackages) { #Installs packages if not yet installed
if (!require(i, character.only = TRUE)) install.packages(i)
}
library(dplyr)
library(httr2)
library(readxl)
library(writexl)
library(purrr)
library(ggplot2)
library(DT)
library(knitr)
library(stringr)
reviews <- readxl::read_excel("tablet_reviews.xlsx")
str(reviews)
review_verified_purch <- reviews %>%
filter(verified_purchase == "Y") %>%
filter(review_date >= "2015-08-01" & review_date <= "2015-08-31")
gen_ai_function <- function(sys_content, user_content) {
api_key <- Sys.getenv("OPENAI_API_KEY")
body <- list(model = "gpt-5-nano",
messages = list(
list(role = "system", content = sys_content),
list(role = "user", content = user_content)
)
)
req <- request("https://api.openai.com/v1")
resp <-
req %>%
req_url_path_append("chat/completions") %>%
req_auth_bearer_token(token = api_key) %>%
req_headers("tontent-type" = "application/jason") %>%
req_body_json(body) %>%
req_perform()
gen_ai_response <- resp %>% resp_body_json(simplifyVector = TRUE)
gen_ai_response$choices$message$content
}
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned) %>%
mutate(sentiment_catagory = "Positive")
view_neg_reviews <- neg_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned) %>%
mutate(sentiment_catagory = "Negative")
view_neu_reviews <- neu_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2) %>%
mutate(category_cleaned = "Uncatagorized", sentiment_catagory = "Neutral")
table_reviews <- bind_rows(view_pos_reviews, view_neg_reviews, view_neu_reviews)
product_parent_n <- unique(table_reviews$product_parent)
table_review_ai_summary <- tibble(
product_parent = product_parent_n, pos_review_summary = pos_review_summary$x, neg_review_summary = neg_review_summary$x
)
write_xlsx(
list(table_reviews = table_reviews, table_review_ai_summary = table_review_ai_summary),
path = paste0(product_parent_n, "_tableau_data.xlsx")
)
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned) %>%
mutate(sentiment_catagory = "Positive")
view_neg_reviews <- neg_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned) %>%
mutate(sentiment_catagory = "Negative")
view_neu_reviews <- neu_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2) %>%
mutate(category_cleaned = "Uncatagorized", sentiment_catagory = "Neutral")
table_reviews <- bind_rows(view_pos_reviews, view_neg_reviews, view_neu_reviews)
product_parent_n <- unique(table_reviews$product_parent)
table_review_ai_summary <- tibble(
product_parent = product_parent_n, pos_review_summary = pos_review_summary$x, neg_review_summary = neg_review_summary$x
)
write_xlsx(
list(table_reviews = table_reviews, table_review_ai_summary = table_review_ai_summary),
path = paste0(product_parent_n, "_tableau_data.xlsx")
)
neg_reviews_summary_table <- neg_reviews %>%
group_by(category_cleaned) %>%
summarise(n_records = n()) %>%
arrange(-n_records)
ggplot(neg_reviews_summary_table, aes(x = reorder(category_cleaned, n_records), y = n_records)) +
geom_bar(stat = "identity", fill = "steelblue") +
coord_flip() +
labs(
title = "Reasons for Negative Reviews - By Category",
x = "Category",
y = "Number of Reviews"
) +
theme_minimal()
# neg_categories <- gen_ai_function(
#   sys_content =
#        "you are reading a list of negative comments on a tablet product review. Choose 10 categories that describe the things a customer did not like about the product. The categories should be only 1 or 2 words. Do not duplicate or choose similar categories. Provide your response as a comma seperated list. Do not use formatting.",
#   user_content = neg_comments
#      )
#
# write.csv(neg_categories, "neg_categories.csv")
neg_categories <- read.csv("neg_categories.csv")
neg_categories <- neg_categories$x
# neg_reviews <- neg_reviews %>%
#   mutate(category = map_chr(review_body, ~ classification_ai(categories = neg_categories, .)))
#
# write.csv(neg_reviews, "neg_reviews.csv")
neg_reviews <- read.csv("neg_reviews.csv")
neg_reviews <- neg_reviews %>%
mutate(category_cleaned = str_to_title(category))
unique(neg_reviews$category_cleaned)
gen_ai_function(sys_content = "Your task is to translate engish words into french" ,
user_content= "Dog")
sentiment_ai <- function(review) {
gen_ai_function(
sys_content =
"You are reading user reviews on a tablet product. Classify the review numerically. If the review is postive then 1 of the review is neutral then 0 and if the review is negative then -1.
examples:
works great // 1
great price // 1
constantly slow // -1
battery life is poor // -1
works for my needs // 0
functions as advertized // 0
",
user_content = review
)
}
sentiment_ai(
"Excellent unit.  The versatility of this tablet, besides being competitively priced is a solution to the elderly.  Poor eyesight and physical disabilities associated with age and using the supporting add on features allows the user to stay in touch with our changing world.<br />A realistic add on keyboard that you can see and use.<br />I cannot wait to use my Fire HD7 to show computer created work sheets and class instructions to my students. (HMDI) Good by to copiers and reams of paper, Farwell to those costly printer inks!<br /><br />Oh yes I have much more to gain back.  Just takes a little effort to learn more, open a book and read.<br />Noel"
)
sentiment_ai(
"We have two kindle fires. The 7 and the 6. They will not connect to my WiFi and if I finally get them to connect it only lasts for a few minutes. I have tried everything to fix but nothing works. I will never buy another kindle fire... Amazon doesn't offer any help to fix the problem"
)
sentiment_ai(
"it does the job"
)
#review_ai_sentiment <- review_verified_purch %>%
#  mutate(sentiment_2 = sapply(review_body, sentiment_ai))
#write.csv(review_ai_sentiment, "review_ai_sentiment.csv")
review_ai_sentiment <- read.csv("review_ai_sentiment.csv")
differing_sentiment <- review_ai_sentiment %>%
filter(sentiment == 1 & sentiment_2 == -1) %>%
select(review_body, sentiment, sentiment_2)
datatable(differing_sentiment, options = list(pageLength = 5), escape = FALSE) %>%
formatStyle(columns = names(df), `font-size` = '10px')
pos_reviews <- review_ai_sentiment %>% filter(sentiment_2 == 1)
neg_reviews <- review_ai_sentiment %>% filter(sentiment_2 == -1)
pos_comments <- paste(pos_reviews$review_body, collapse = "\n")
neg_comments <- paste(neg_reviews$review_body, collapse = "\n")
# pos_review_summary <- gen_ai_function(
#   sys_content = "you are reading a list of positive comments on a tablet product review. Summarize the the top 5 reasons for positive reviews with a short explanation" ,
#   user_content= pos_comments
#   )
#
# write.csv(pos_review_summary, "pos_review_summary.csv")
pos_review_summary <- read.csv("pos_review_summary.csv")
pos_review_summary$x
# neg_review_summary <- gen_ai_function(
#   sys_content = "you are reading a list of negative comments on a tablet product review. Summarize the the top 5 reasons for negative reviews with a short explanation" ,
#   user_content= neg_comments
#   )
# write.csv(neg_review_summary, "neg_review_summary.csv")
neg_review_summary <- read.csv("neg_review_summary.csv")
neg_review_summary$x
# pos_categories <- gen_ai_function(
#   sys_content =
#       "you are reading a list of positive comments on a tablet product review. Choose 10 categories that describe the things a customer liked about the product. The categories should be only 1 or 2 words. Do not duplicate or choose similar categories. Provide your response as a comma seperated list. Do not use formatting.",
#    user_content = pos_comments
#       )
#
# write.csv(pos_categories, "pos_categories.csv")
pos_categories <- read.csv("pos_categories.csv")
pos_categories <- pos_categories$x
print(pos_categories)
classification_ai <- function(string, categories) {
gen_ai_function(
sys_content = paste0("You are reading user reviews on a tablet product. classify the review in one of the following categories: ", categories, " or OTHER. ONLY respond with these categories. Do not deviate from these categores. Only choose OTHER when none of the other categories truly do not fit. Do not choose more than one category"),
user_content = string
)
}
# pos_reviews <- pos_reviews %>%
#  mutate(category = map_chr(review_body, ~ classification_ai(categories = pos_categories, .)))
#
# write.csv(pos_reviews, "pos_reviews.csv")
pos_reviews <- read.csv("pos_reviews.csv")
unique(pos_reviews$category)
pos_reviews <- pos_reviews %>%
mutate(category_cleaned = str_to_title(category))
unique(pos_reviews$category_cleaned)
ggplot(pos_reviews_summary_table, aes(x = reorder(category_cleaned, n_records), y = n_records)) +
geom_bar(stat = "identity", fill = "steelblue") +
coord_flip() +
labs(
title = "Reasons for Positive Reviews - By Category",
x = "Category",
y = "Number of Reviews"
) +
theme_minimal()
# neg_categories <- gen_ai_function(
#   sys_content =
#        "you are reading a list of negative comments on a tablet product review. Choose 10 categories that describe the things a customer did not like about the product. The categories should be only 1 or 2 words. Do not duplicate or choose similar categories. Provide your response as a comma seperated list. Do not use formatting.",
#   user_content = neg_comments
#      )
#
# write.csv(neg_categories, "neg_categories.csv")
neg_categories <- read.csv("neg_categories.csv")
neg_categories <- neg_categories$x
# neg_reviews <- neg_reviews %>%
#   mutate(category = map_chr(review_body, ~ classification_ai(categories = neg_categories, .)))
#
# write.csv(neg_reviews, "neg_reviews.csv")
neg_reviews <- read.csv("neg_reviews.csv")
neg_reviews <- neg_reviews %>%
mutate(category_cleaned = str_to_title(category))
unique(neg_reviews$category_cleaned)
neg_reviews_summary_table <- neg_reviews %>%
group_by(category_cleaned) %>%
summarise(n_records = n()) %>%
arrange(-n_records)
ggplot(neg_reviews_summary_table, aes(x = reorder(category_cleaned, n_records), y = n_records)) +
geom_bar(stat = "identity", fill = "steelblue") +
coord_flip() +
labs(
title = "Reasons for Negative Reviews - By Category",
x = "Category",
y = "Number of Reviews"
) +
theme_minimal()
view_pos_reviews <- pos_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned) %>%
mutate(sentiment_catagory = "Positive")
view_neg_reviews <- neg_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2, category_cleaned) %>%
mutate(sentiment_catagory = "Negative")
view_neu_reviews <- neu_reviews %>%
select(marketplace, review_id, product_id, product_parent, product_title, star_rating, review_headline, review_body, review_date, sentiment_2) %>%
mutate(category_cleaned = "Uncatagorized", sentiment_catagory = "Neutral")
table_reviews <- bind_rows(view_pos_reviews, view_neg_reviews, view_neu_reviews)
product_parent_n <- unique(table_reviews$product_parent)
table_review_ai_summary <- tibble(
product_parent = product_parent_n, pos_review_summary = pos_review_summary$x, neg_review_summary = neg_review_summary$x
)
write_xlsx(
list(table_reviews = table_reviews, table_review_ai_summary = table_review_ai_summary),
path = paste0(product_parent_n, "_tableau_data.xlsx")
)
